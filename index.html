<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PG ReCycle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0b1a2a;
      color: #fff;
    }

    nav {
      padding: 15px 20px;
      background: #08131f;
      font-weight: bold;
    }

    .container {
      padding: 20px;
    }

    .card {
      background: #08131f;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    button {
      padding: 10px;
      background: #123;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<nav>♻ PG ReCycle</nav>

<div class="container">

  <!-- HOME PAGE -->
  <div id="homePage" class="card hidden">
    <h2>Welcome to PG ReCycle</h2>
    <p>Scan a QR code on an item to request it.</p>
  </div>

  <!-- ITEM PAGE (FROM QR) -->
  <div id="itemPage" class="card hidden">
    <h3 id="itemName"></h3>
    <p id="itemDesc"></p>
    <p><b>Condition:</b> <span id="itemCond"></span></p>
    <p><b>Location:</b> <span id="itemLoc"></span></p>
    <button onclick="requestItem()">Request Item (−5 credits)</button>
  </div>

</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "pg-recycle-connect2.firebaseapp.com",
    projectId: "pg-recycle-connect2"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const params = new URLSearchParams(window.location.search);
  const itemId = params.get("item");

  const homePage = document.getElementById("homePage");
  const itemPage = document.getElementById("itemPage");

  // NO ITEM → HOME PAGE
  if (!itemId) {
    homePage.classList.remove("hidden");
  } 
  // ITEM PRESENT → LOAD ITEM
  else {
    loadItem(itemId);
  }

  async function loadItem(id) {
    const snap = await getDoc(doc(db, "items", id));

    if (!snap.exists()) {
      homePage.innerHTML = "<h3>Item not found</h3>";
      homePage.classList.remove("hidden");
      return;
    }

    const item = snap.data();

    document.getElementById("itemName").innerText = item.itemName;
    document.getElementById("itemDesc").innerText = item.description;
    document.getElementById("itemCond").innerText = item.condition;
    document.getElementById("itemLoc").innerText = item.location;

    itemPage.classList.remove("hidden");
  }

  window.requestItem = function () {
    alert("Request logic will be added next");
  };
</script>

</body>
</html>
